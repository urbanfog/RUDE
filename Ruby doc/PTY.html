<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: PTY
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "PTY";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (P)</a> &raquo;
    
    
    <span class="title">PTY</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: PTY
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>ext/pty/pty.c</dd>
  </dl>
  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="PTY/ChildExited.html" title="PTY::ChildExited (class)">ChildExited</a></span>
    
  
</p>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check-class_method" title="check (class method)">.<strong>check</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks the status of the child process specified by <code>pid</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getpty-class_method" title="getpty (class method)">.<strong>getpty</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Spawns the specified command on a newly allocated pty.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#open-class_method" title="open (class method)">.<strong>open</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Allocates a pty (pseudo-terminal).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#spawn-class_method" title="spawn (class method)">.<strong>spawn</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Spawns the specified command on a newly allocated pty.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="check-class_method">
  
    
      <span class="overload">.<strong>check</strong>(pid, raise = false)  &#x21d2; <tt>Process::Status</tt><sup>?</sup> </span>
    
      <span class="overload">.<strong>check</strong>(pid, true)  &#x21d2; <tt>nil</tt>, <tt>raises <span class='object_link'><a href="PTY/ChildExited.html" title="PTY::ChildExited (class)">PTY::ChildExited</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks the status of the child process specified by <code>pid</code>.
Returns <code>nil</code> if the process is still alive.</p>

<p>If the process is not alive, and <code>raise</code> was true, a
PTY::ChildExited exception will be raised. Otherwise it will return a
Process::Status instance.</p>
<dl class="rdoc-list note-list"><dt><code>pid</code>
<dd>
<p>The process id of the process to check</p>
</dd><dt><code>raise</code>
<dd>
<p>If <code>true</code> and the process identified by <code>pid</code> is no
longer alive a PTY::ChildExited is raised.</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">.<strong>check</strong>(pid, raise = false)  &#x21d2; <tt>Process::Status</tt><sup>?</sup> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Process::Status</tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>check</strong>(pid, true)  &#x21d2; <tt>nil</tt>, <tt>raises <span class='object_link'><a href="PTY/ChildExited.html" title="PTY::ChildExited (class)">PTY::ChildExited</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>, <tt>raises <span class='object_link'><a href="PTY/ChildExited.html" title="PTY::ChildExited (class)">PTY::ChildExited</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/pty/pty.c', line 645</span>

static VALUE
pty_check(int argc, VALUE *argv, VALUE self)
{
    VALUE pid, exc;
    rb_pid_t cpid;
    int status;
    const int flag =
#ifdef WNOHANG
	WNOHANG|
#endif
#ifdef WUNTRACED
	WUNTRACED|
#endif
	0;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;pid, &amp;exc);
    cpid = rb_waitpid(NUM2PIDT(pid), &amp;status, flag);
    if (cpid == -1 || cpid == 0) return Qnil;

    if (!RTEST(exc)) return rb_last_status_get();
    raise_from_check(cpid, status);

    UNREACHABLE;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getpty-class_method">
  
    
      <span class="overload">.<strong>spawn</strong>(command_line) {|r, w, pid| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
    
      <span class="overload">.<strong>spawn</strong>(command_line)  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
    
      <span class="overload">.<strong>spawn</strong>(command, arguments, ...) {|r, w, pid| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
    
      <span class="overload">.<strong>spawn</strong>(command, arguments, ...)  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Spawns the specified command on a newly allocated pty. You can also use the
alias ::getpty.</p>

<p>The command&#39;s controlling tty is set to the slave device of the pty and
its standard input/output/error is redirected to the slave device.</p>

<p><code>command</code> and <code>command_line</code> are the full commands to
run, given a String. Any additional <code>arguments</code> will be passed
to the command.</p>

<h3 id="label-Return+values">Return values</h3>

<p>In the non-block form this returns an array of size three, <code>[r, w,
pid]</code>.</p>

<p>In the block form these same values will be yielded to the block:</p>
<dl class="rdoc-list note-list"><dt><code>r</code>
<dd>
<p>A readable IO that contains the command&#39;s standard output and standard
error</p>
</dd><dt><code>w</code>
<dd>
<p>A writable IO that is the command&#39;s standard input</p>
</dd><dt><code>pid</code>
<dd>
<p>The process identifier for the command.</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spawn</strong>(command_line) {|r, w, pid| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>r</tt>, <tt>w</tt>, <tt>pid</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spawn</strong>(command_line)  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spawn</strong>(command, arguments, ...) {|r, w, pid| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>r</tt>, <tt>w</tt>, <tt>pid</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spawn</strong>(command, arguments, ...)  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/pty/pty.c', line 561</span>

static VALUE
pty_getpty(int argc, VALUE *argv, VALUE self)
{
    VALUE res;
    struct pty_info info;
    rb_io_t *wfptr,*rfptr;
    VALUE rport = rb_obj_alloc(rb_cFile);
    VALUE wport = rb_obj_alloc(rb_cFile);
    char SlaveName[DEVICELEN];

    MakeOpenFile(rport, rfptr);
    MakeOpenFile(wport, wfptr);

    establishShell(argc, argv, &amp;info, SlaveName);

    rfptr-&gt;mode = rb_io_modestr_fmode(&quot;r&quot;);
    rfptr-&gt;fd = info.fd;
    rfptr-&gt;pathv = rb_obj_freeze(rb_str_new_cstr(SlaveName));

    wfptr-&gt;mode = rb_io_modestr_fmode(&quot;w&quot;) | FMODE_SYNC;
    wfptr-&gt;fd = rb_cloexec_dup(info.fd);
    if (wfptr-&gt;fd == -1)
        rb_sys_fail(&quot;dup()&quot;);
    rb_update_max_fd(wfptr-&gt;fd);
    wfptr-&gt;pathv = rfptr-&gt;pathv;

    res = rb_ary_new2(3);
    rb_ary_store(res,0,(VALUE)rport);
    rb_ary_store(res,1,(VALUE)wport);
    rb_ary_store(res,2,PIDT2NUM(info.child_pid));

    if (rb_block_given_p()) {
	rb_ensure(rb_yield, res, pty_detach_process, (VALUE)&amp;info);
	return Qnil;
    }
    return res;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="open-class_method">
  
    
      <span class="overload">.<strong>open</strong>  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
    
      <span class="overload">.<strong>open</strong> {|master_io, slave_file| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Allocates a pty (pseudo-terminal).</p>

<p>In the block form, yields two arguments <code>master_io, slave_file</code>
and the value of the block is returned from <code>open</code>.</p>

<p>The IO and File are both closed after the block completes if they
haven&#39;t been already closed.</p>

<pre class="code"><code class=""><span class='const'><span class='object_link'><a href="" title="PTY (module)">PTY</a></span></span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_master'>master</span><span class='comma'>,</span> <span class='id identifier rubyid_slave'>slave</span><span class='op'>|</span>
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_master'>master</span>      <span class='comment'>#=&gt; #&lt;IO:masterpty:/dev/pts/1&gt;
</span>  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_slave'>slave</span>      <span class='comment'>#=&gt; #&lt;File:/dev/pts/1&gt;
</span>  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_slave'>slave</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span> <span class='comment'>#=&gt; &quot;/dev/pts/1&quot;
</span><span class='rbrace'>}</span>
</code></pre>

<p>In the non-block form, returns a two element array, <code>[master_io,
slave_file]</code>.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_master'>master</span><span class='comma'>,</span> <span class='id identifier rubyid_slave'>slave</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="PTY (module)">PTY</a></span></span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span>
<span class='comment'># do something with master for IO, or the slave file
</span></code></pre>

<p>The arguments in both forms are:</p>
<dl class="rdoc-list note-list"><dt><code>master_io</code>
<dd>
<p>the master of the pty, as an IO.</p>
</dd><dt><code>slave_file</code>
<dd>
<p>the slave of the pty, as a File.  The path to the</p>
</dd></dl>

<p>terminal device is available via <code>slave_file.path</code></p>

<p>IO#raw! is usable to disable newline conversions:</p>

<pre class="code"><code class="">require &#39;io/console&#39;
PTY.open {|m, s|
  s.raw!
  ...
}</code></pre>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">.<strong>open</strong>  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>open</strong> {|master_io, slave_file| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>master_io</tt>, <tt>slave_file</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/pty/pty.c', line 491</span>

static VALUE
pty_open(VALUE klass)
{
    int master_fd, slave_fd;
    char slavename[DEVICELEN];
    VALUE master_io, slave_file;
    rb_io_t *master_fptr, *slave_fptr;
    VALUE assoc;

    getDevice(&amp;master_fd, &amp;slave_fd, slavename, 1);

    master_io = rb_obj_alloc(rb_cIO);
    MakeOpenFile(master_io, master_fptr);
    master_fptr-&gt;mode = FMODE_READWRITE | FMODE_SYNC | FMODE_DUPLEX;
    master_fptr-&gt;fd = master_fd;
    master_fptr-&gt;pathv = rb_obj_freeze(rb_sprintf(&quot;masterpty:%s&quot;, slavename));

    slave_file = rb_obj_alloc(rb_cFile);
    MakeOpenFile(slave_file, slave_fptr);
    slave_fptr-&gt;mode = FMODE_READWRITE | FMODE_SYNC | FMODE_DUPLEX | FMODE_TTY;
    slave_fptr-&gt;fd = slave_fd;
    slave_fptr-&gt;pathv = rb_obj_freeze(rb_str_new_cstr(slavename));

    assoc = rb_assoc_new(master_io, slave_file);
    if (rb_block_given_p()) {
	return rb_ensure(rb_yield, assoc, pty_close_pty, assoc);
    }
    return assoc;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="spawn-class_method">
  
    
      <span class="overload">.<strong>spawn</strong>(command_line) {|r, w, pid| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
    
      <span class="overload">.<strong>spawn</strong>(command_line)  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
    
      <span class="overload">.<strong>spawn</strong>(command, arguments, ...) {|r, w, pid| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
    
      <span class="overload">.<strong>spawn</strong>(command, arguments, ...)  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Spawns the specified command on a newly allocated pty. You can also use the
alias ::getpty.</p>

<p>The command&#39;s controlling tty is set to the slave device of the pty and
its standard input/output/error is redirected to the slave device.</p>

<p><code>command</code> and <code>command_line</code> are the full commands to
run, given a String. Any additional <code>arguments</code> will be passed
to the command.</p>

<h3 id="label-Return+values">Return values</h3>

<p>In the non-block form this returns an array of size three, <code>[r, w,
pid]</code>.</p>

<p>In the block form these same values will be yielded to the block:</p>
<dl class="rdoc-list note-list"><dt><code>r</code>
<dd>
<p>A readable IO that contains the command&#39;s standard output and standard
error</p>
</dd><dt><code>w</code>
<dd>
<p>A writable IO that is the command&#39;s standard input</p>
</dd><dt><code>pid</code>
<dd>
<p>The process identifier for the command.</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spawn</strong>(command_line) {|r, w, pid| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>r</tt>, <tt>w</tt>, <tt>pid</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spawn</strong>(command_line)  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spawn</strong>(command, arguments, ...) {|r, w, pid| ... } &#x21d2; <tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>r</tt>, <tt>w</tt>, <tt>pid</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spawn</strong>(command, arguments, ...)  &#x21d2; <tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/pty/pty.c', line 561</span>

static VALUE
pty_getpty(int argc, VALUE *argv, VALUE self)
{
    VALUE res;
    struct pty_info info;
    rb_io_t *wfptr,*rfptr;
    VALUE rport = rb_obj_alloc(rb_cFile);
    VALUE wport = rb_obj_alloc(rb_cFile);
    char SlaveName[DEVICELEN];

    MakeOpenFile(rport, rfptr);
    MakeOpenFile(wport, wfptr);

    establishShell(argc, argv, &amp;info, SlaveName);

    rfptr-&gt;mode = rb_io_modestr_fmode(&quot;r&quot;);
    rfptr-&gt;fd = info.fd;
    rfptr-&gt;pathv = rb_obj_freeze(rb_str_new_cstr(SlaveName));

    wfptr-&gt;mode = rb_io_modestr_fmode(&quot;w&quot;) | FMODE_SYNC;
    wfptr-&gt;fd = rb_cloexec_dup(info.fd);
    if (wfptr-&gt;fd == -1)
        rb_sys_fail(&quot;dup()&quot;);
    rb_update_max_fd(wfptr-&gt;fd);
    wfptr-&gt;pathv = rfptr-&gt;pathv;

    res = rb_ary_new2(3);
    rb_ary_store(res,0,(VALUE)rport);
    rb_ary_store(res,1,(VALUE)wport);
    rb_ary_store(res,2,PIDT2NUM(info.child_pid));

    if (rb_block_given_p()) {
	rb_ensure(rb_yield, res, pty_detach_process, (VALUE)&amp;info);
	return Qnil;
    }
    return res;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Feb 26 22:17:43 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.4.2).
</div>

    </div>
  </body>
</html>